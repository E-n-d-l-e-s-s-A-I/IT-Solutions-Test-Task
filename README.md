# IT—Solutions Тестовое Задание

# Оглавление
1. [Установка и запуск](#Установкаизапуск)
2. [Функциональность](#Функциональность)
3. [Технлогии](#Технлогии)
4. [Модели](#Модели)
5. [Маршруты, Представления, Шаблоны](#маршрутыпредставленияшаблоны)
6. [Статика](#Статика)
7. [API](#API)

## Название: 
Создание веб—приложения для управления информацией об автомобилях с использованием API.

## Установка и запуск: 
1. Клониоровать репозиторий.
``` 
git clone https://github.com/E-n-d-l-e-s-s-A-I/IT-Solutions-Test-Task
```
2. Создать виртуальное окружение и установить зависимости.

    в дириектории проекта выполнить консольные команды:
    ```
    python -m venv venv
    venv\scripts\activate
    pip install -r requirements.txt
    ```
3. Перейти в директорию приложения, применить миграции, и загрузить данные.
    ```
    cd it_solutions_test_task
    python manage.py migrate
    python manage.py loaddata db.json
    ```
4. Запустить локальный сервер разработки.
    ```
    python manage.py runserver
    ```
5. Теперь сервер запущен и можно пользоваться всеми маршрутами с локального хоста `http://127.0.0.1:8000/`.
## Функциональность:
1. Автомобили
    - Просмотр всех автомобилей
    - Просмотр детальной информации об автомобиле
    - Добавление новой записи об автомобиле (доступно только зарегистрированным пользователям)
    - Просмотр добавленных пользователем записей об автомобилях (доступно только зарегистрированным пользователям)
    - Удаление и редактирование записей об автомобилях (доступно только создателям записей)
2. Комментарии
    - Просмотр комментариев под записью об автомобиле
    - Оставление комментария под записью об автомобиле (доступно только зарегистрированным пользователям)

## Технлогии:
Python 3.10.11, Django 4.2.16, Django REST Framework ?, SQLite

## Модели:

- __Car__
    - make (марка автомобиля) — символьное поле с ограничением длины 100 символов.
    - model (модель автомобиля) — символьное поле с ограничением длины 100 символов.
    - year (год выпуска) — целое число от 1885 до настойщего года.
    - description (описание автомобиля) — тектовое поле.
    - created_at (дата и время создания записи) — поле даты и времени.
    - updated_at (дата и время последнего обновления записи) — поле даты и времени.
    - owner (внешний ключ на пользователя, который создал запись) — поле ForeignKey.

- __Comment__
    - content (содержание комментария) — текстовое поле.
    - created_at (дата и время создания комментария) — поле даты и времени. 
    - car (внешний ключ  на автомобиль) — поле ForeignKey.
    - author (внешний ключ на пользователя) — поле ForeignKey.

Все модели были зарегистрированы и настроены в для работы в админке, а так же локализованы

Некоторые ограничения, не были заданы в тестовом задании, и были выбраны мной самостоятльно, исходя из специфики предметной области.

## Маршруты/Представления/Шаблоны:

- `/admin/` — админка с ее стандартными путями, представлениями и шаблонами.

- `/login/` — авторизации.

    - используется стандартное представление из django.contrib.auth.

    - используемый шаблон — `it_solutions_test_task\templates\registration\login.html`.

- `/logout/` — выход из системы.

    - используется стандартное представление из django.contrib.auth.

    - используемый шаблон — `it_solutions_test_task\templates\registration\logged_out.html`.

- `/registration/` — регистрация.

    - используется CBV CreateView.

    - используемый шаблон — `it_solutions_test_task\templates\registration\registration_form.html`.

- `/cars/` — главная страница, со списком всех записей об автомобилях.

    - используется CBV Homepage.

    - используемый шаблон — `it_solutions_test_task\templates\cars\index.html`.

- `/my_cars/` — страница, со списком записей об автомобилях пользователя.

    - используется CBV MyCarListView.

    - используемый шаблон — `it_solutions_test_task\templates\cars\my_car_list.html`.

    - без авторизации происходит редирект на `/login/`.

- `/cars/<int:pk>/` — страница, детальной информации о автомобиле.

    - используется CBV CarDetailView.

    - используемый шаблон — `it_solutions_test_task\templates\cars\car_detail.html`.

    - для всех пользователей отображаются комментарии.

    - для авторизованных пользователей отображается форма отправки комментария.

    - POST запрос авторизованного пользователя добавляет комментарий.

    - POST запрос неавторизованного пользователя возвращает 403.

- `/cars/add/` — страница, с формой добавления запси об автомобиле.

    - используется CBV CarCreateView.

    - используемый шаблон — `it_solutions_test_task\templates\cars\car_form.html`.

    - POST запрос авторизованного пользователя добавляет запись об автомобиле.

    - GET запрос неавторизованного пользователя редиректит на `/login/`.
    - POST запрос неавторизованного пользователя возвращает 403.

- `cars/delete/<int:pk>/` — страница, с формой подтверждения удаления записи об автомобиле.

    - используется CBV CarDeleteView.

    - используемый шаблон — `it_solutions_test_task\templates\cars\car_confirm_delete.html`.

    - GET запрос пользователя, являющегося автором записи об автомобиле, возвращает форму подтверждения удаления.

    - POST запрос пользователя, являющегося автором записи об автомобиле, удаляет запись об автомобиле.

    - POST или GET запрос пользователя, не являющегося автором записи об автомобиле, возвращает 403.

- `cars/edit/<int:pk>/` — страница, с формой изменения записи об автомобиле.

    - используется CBV CarUpdateView.

    - используемый шаблон — `it_solutions_test_task\templates\cars\car_form.html.html`.

    - GET запрос пользователя, являющегося автором записи об автомобиле, возвращает форму изменения записи об автомобиле.

    - POST запрос пользователя, являющегося автором записи об автомобиле, измененяет запись об автомобиле.

    - POST или GET запрос пользователя, не являющегося автором записи об автомобиле, возвращает 403.

## Статика:
Все статические файлы находятся в  `it_solutions_test_task\static`

- `css` - папка со стилями
    - `fonts.css` — подключение шрифтов.
    - `reset-browser-styles.css` — сброс стилей браузера.
    - `styles.css` — основные стили проекта.
    
- `fonts` - папка со шрифтами.

## API:
Api реализовано в дириктории api приложения cars.

Аутентификация в api реализована через токены.

Реализованы следующие эндпоинты:

- POST `/api/auth/token/login` — аутентификация 

    Тело запроса
    ```
    {
        "username": "text",
        "password": "text"
    }
    ```
    Ответы:

    - 200 OK: успешная аутентификация.
    ```
    {
        "token": "text"
    }
    ```
    - 400 Bad Request: Невозможно войти с предоставленными учетными данными.
    - 

- Get `/api/cars/` — получение списка автомобилей. 

    Ответы:

    - 200 OK: список автомобилей
    ```
    {
        [
            {
                "id": 2,
                "created_at": "2024-10-14T05:27:56.615002Z",
                "make": "Ford",
                "model": "Mustang",
                "year": null,
                "description": "Спортивный автомобиль",
                "updated_at": "2024-10-15T15:12:52.448289Z"
            },
            {
                "id": 3,
                "created_at": "2024-10-14T05:28:18.240660Z",
                "make": "Honda",
                "model": "Civic",
                "year": 2020,
                "description": "Надежный и экономичный седан, идеален для городской эксплуатации.",
                "updated_at": "2024-10-14T05:30:49.063498Z"
            },
            ...
        ]
    }
    ```
- Get `/api/cars/<id>/` — получение информации о конкретном автомобиле. 

    Ответы:
    - 200 OK: информация об автомобиле.
    ```
    {
        "id": 2,
        "created_at": "2024-10-14T05:27:56.615002Z",
        "make": "Ford",
        "model": "Mustang",
        "year": null,
        "description": "Спортивный автомобиль",
        "updated_at": "2024-10-15T15:12:52.448289Z"
    }
    ```
    - 404 Not Found: No Car matches the given query.

- Post `/api/cars/` — добавление информации о конкретном автомобиле. Доступно только аутентифицированным пользователям.

    Тело запроса:
    ```
    {
        "make": "text",
        "model": "text",
        "description": "text",
        "year": "text" # необязательное поле
    }
    ```

    Заголовки запроса:
    
    - Authorization: Token <token>

    
    Ответы:
    - 201 OK: запись об автомобиле добавлена.
    ```
    {
        "id": 17,
        "created_at": "2024-10-18T13:40:29.630283Z",
        "make": "suzuki",
        "model": "grand vitara 2",
        "year": null,
        "description": "моя машина",
        "updated_at": "2024-10-18T13:40:29.630283Z"
    }
    ```
    - 400 Bad Request: Неверные параметры запроса.
    - 401 Unauthorized: Учетные данные не были предоставлены.

- PUT `/api/cars/<id>/` — обновление информации о автомобиле. Доступно только владельцу записи об автомобиля.


    Тело запроса:
    ```
    {
        "make": "text",
        "model": "text",
        "description": "text",
        "year": "text" # необязательное поле
    }
    ```

    Заголовки запроса:
    
    - Authorization: Token <token>

    Ответы:
    - 201 Created: запись об автомобиле изменена.
    ```
    {
        "id": 17,
        "created_at": "2024-10-18T13:40:29.630283Z",
        "make": "suzuki",
        "model": "grand vitara 2",
        "year": null,
        "description": "моя машина",
        "updated_at": "2024-10-18T13:40:29.630283Z"
    }
    ```
    - 400 Bad Request: Неверные параметры запроса.
    - 401 Unauthorized: Учетные данные не были предоставлены.
    - 403 Bad Request: У вас недостаточно прав для выполнения данного действия.
    - 404 Not Found: No Car matches the given query.
   

- DELETE `/api/cars/<id>/` — удаление записии об автомобиле. Доступно только владельцу записи об автомобиля.

    Тело запроса:

        Заголовки запроса:
        
        - Authorization: Token <token>

        Ответы:
        - 204 No Content: запись об автомобиле удалена.
        - 400 Bad Request: Неверные параметры запроса.
        - 401 Unauthorized: Учетные данные не были предоставлены.
        - 403 Bad Request: У вас недостаточно прав для выполнения данного действия.
        - 404 Not Found: No Car matches the given query.

- GET `/api/cars/<id>/comments/` — получение комментариев к записии об автомобиле.

    Ответы:
    - 200 OK: список комментариев к автомобилю
    ```
    [
        {
            "id": 22,
            "created_at": "2024-10-18T12:41:54.026998Z",
            "content": "comment3",
            "car": 2
        },
        {
            "id": 21,
            "created_at": "2024-10-18T12:41:04.856270Z",
            "content": "comment2",
            "car": 2
        },
        ...
    ]
    ```
    - 404 Not Found: No Car matches the given query.

- Put `/api/cars/<id>/comments/` — добавление комментария к записии об автомобиле. Доступно только аутентифицированным пользователям.
    Тело запроса:
    ```
    {
        "content": "text"
    }
    ```

    Заголовки запроса:
    
    - Authorization: Token <token>

    Ответы:
    - 200 OK: список комментариев к автомобилю
    ```
    [
        {
            "id": 22,
            "created_at": "2024-10-18T12:41:54.026998Z",
            "content": "comment3",
            "car": 2
        },
        {
            "id": 21,
            "created_at": "2024-10-18T12:41:04.856270Z",
            "content": "comment2",
            "car": 2
        },
        ...
    ]
    ```
    - 201 Created: комментарий добавлен.
    ```
    {
        "id": 23,
        "created_at": "2024-10-18T14:01:17.402568Z",
        "content": "обычный комментарий",
        "car": 2
    }
    ```
     - 400 Bad Request: Неверные параметры запроса.
     - 401 Unauthorized: Учетные данные не были предоставлены.
    - 403 Bad Request: У вас недостаточно прав для выполнения данного действия.
    - 404 Not Found: No Car matches the given query.